<!DOCTYPE html>
<head>
<link rel="stylesheet" href="mycss.css">
</head>
<html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<body>

<div class="container">
  <div class="objekty">
      <form>
        Premenná X: <br>
         <textarea id="cislo1" rows="10" cols="15" name="cislo1"></textarea>
  </div>
  <div class="objekty">
         Premenná Y:
         <textarea id="cislo2" rows="10" cols="15" name="cislo2"></textarea>
  </div>
  <br>
    <label for="koeficient">Koeficient:</label>
      <select name="koeficient" id="koeficient">
        <option value="pearson">Pearson</option>
        <option value="spearman">Spearman</option>
        <option value="kendall">Kendall</option>
      </select><br>
    <button type="button" onclick="myFunction()" name="button" class="button1">ENTER</button><br>
    <p id="result"></p>
    </form>
</div>

<div class="graf">
<canvas id="myChart" style="width:100%;max-width:700px"></canvas>
</div>

<script>
function myFunction() {

  var stringX = document.getElementById("cislo1").value;
  var stringY = document.getElementById("cislo2").value;

  var poleStringovX = stringX.split(/\n| /);
  var poleIntov1 = poleStringovX.map(Number);
  var poleStringovY = stringY.split(/\n| /);
  var poleIntov2 = poleStringovY.map(Number);

  if (poleIntov1.length != poleIntov2.length) {
    alert("Premenné sú rôzne dlhe");
  }
  else if (poleIntov1.length==1 | poleIntov2.length==1) {
    alert("Pole premennej obsahuje málo parametrov");
  }
  else {

  let sx = 0.0;
  let sy = 0.0;
  let sxx = 0.0;
  let syy = 0.0;
  let sxy = 0.0;


  let n = poleStringovX.length;
  var storage = [];

  for (var i = 0; i < n; i++) {
    var x = poleIntov1[i];
    var y = poleIntov2[i];
    var json = {x: x, y: y};
    storage.push(json); //naplnenie dat v pozadovanej forme grafu do bodov

    sx += x;
    sy += y;
    sxx += x * x;
    syy += y * y;
    sxy += x * y;
  }

  let cov = sxy / n - sx * sy / n / n;
  let sigmax = Math.sqrt(sxx / n -  sx * sx / n / n);
  let sigmay = Math.sqrt(syy / n -  sy * sy / n / n);
  let korelacia = cov / sigmax / sigmay;

  document.getElementById("result").innerHTML="Korelacia sa rovna: " + korelacia;

  var ctxLine = document.getElementById("myChart").getContext("2d");
  if(window.bar != undefined)
  window.bar.destroy();
  window.bar = new Chart("myChart", {
    type: "scatter",
    data: {
      datasets: [{
        pointRadius: 4,
        pointBackgroundColor: "rgb(0,112,238)",
        data: storage
      }]
    },
    options: {
      legend: {display: false},
      scales: {
        xAxes: [{ticks: {min: Math.min.apply(Math, poleIntov1), max:Math.max.apply(Math, poleIntov1)}}],
        yAxes: [{ticks: {min: Math.min.apply(Math, poleIntov2), max:Math.max.apply(Math, poleIntov2)}}],
      }
    }
  });

  }
}
</script>

</body>
</html>
